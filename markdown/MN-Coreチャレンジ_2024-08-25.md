# MN-Coreチャレンジに参加したときの日記
PFNがMN-Coreを開放したプログラミングコンテストを行っているんで参加する。
***
## 8/25 とりあえず入門

### やったこと
\[MN-Core勉強会\](https://www.youtube.com/watch?v=U4HjE2S8wAY)のYouTubeを視聴しました。また、MN-Coreの\[開発者マニュアル\](https://projects.preferred.jp/mn-core/assets/mncore2_dev_manual_ja.pdf)をKindleにダウンロードして読みました。

### 知見

#### チップ構造
- チップ -&gt; L2B -&gt; L1B -&gt; MAB -&gt; &#123;PE \| MAU&#125; という包括的な構造になっているらしい。
- PE \(Processing Element\)：普通のCPUの延長線上っぽい。
- Matrix Arithmetic Unit：行列演算を行うユニット、転置やMACができるらしい。TPUのシストリックアレイに似たものかもしれない。
- L1B：MABが16個とか32個の集合で、L1B MemoryやL1B Reduction Unitが含まれる。
- L2B：L1Bを8個束ねたものらしい。L2B MemoryやL2B Reduction Unitが含まれる。

#### メモリ空間の分離
- PEからグローバルメモリにアクセスすることができない。PEからアクセス可能なのはPEが持つメモリ利用域だけ。
- PEでデータを利用するためには、DRAM -&gt; L2B -&gt; L1B -&gt; PEという段階的な転送が必要になる。

#### 演算の制御
- PEに命令発行ユニットがない。
- PCI Expressから命令を流し込んで実行する。

- 命令の種類
  - PE命令
  - MAU命令
  - L1B命令：L1B &lt;=&gt; MAB間の転送命令
  - L2B命令：L2B &lt;=&gt; L1B間の転送命令
  - DRAM/PDM命令：L2B &lt;=&gt; DRAM間の転送命令

これらの命令が次のようなVLIWになる。

| PE命令 | MAU命令 | L1B転送命令 | L2B転送命令 | DRAM命令 |
|--------|---------|-------------|-------------|----------|

### 感想とかいろいろ
- 機械学習の性質から決定論的にメモリアクセスを行うのでキャッシュがいらないのかもしれない。
- ハードウェアの機能をソフトウェアに置き換えている。→可塑性が高く、効率的にできる。
- 機械学習のノウハウから強力なコンパイラが構築でき、MN-Coreを効果的に扱えるようになるっぽい。
- PyTorchでGPUのように扱えるソフトウェアスタックが用意されている。
- データパラレルの時代はAll Reduce（データを配布して計算して集める処理）について考えればよかったが、現在のLLMでは直列のパイプラインが重要。
- PFN、IIJ、JAISTが共同研究している。→この前VDECで回ってきたAIプロセッサの公募はもしかしてこれか？
- なんというかCGRAに近い、NAISTで開発されていたEMAXに似ている。

### 積み残し
それぞれの命令の機能がまだわからない。明日は命令のリストを作ってチェックする。


***
